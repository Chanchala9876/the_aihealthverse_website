<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${title}">Health Analysis - HealthVerse</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #4F46E5;
            --secondary-color: #7C3AED;
            --success-color: #10B981;
            --warning-color: #F59E0B;
            --danger-color: #EF4444;
            --light-bg: #F8FAFC;
            --dark-text: #1F2937;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .navbar {
            background: rgba(255, 255, 255, 0.95) !important;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .navbar-brand {
            font-weight: 700;
            color: var(--primary-color) !important;
        }
        
        .nav-link {
            font-weight: 500;
            color: var(--dark-text) !important;
            transition: color 0.3s ease;
        }
        
        .nav-link:hover {
            color: var(--primary-color) !important;
        }
        
        .main-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            margin: 2rem auto;
            padding: 2rem;
            backdrop-filter: blur(10px);
        }
        
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 1.5rem;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .analysis-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .insight-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-left: 4px solid var(--primary-color);
        }
        
        .trend-indicator {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        .trend-positive { background-color: #D1FAE5; color: #065F46; }
        .trend-negative { background-color: #FEE2E2; color: #991B1B; }
        .trend-neutral { background-color: #FEF3C7; color: #92400E; }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border: none;
            border-radius: 10px;
            padding: 12px 24px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(79, 70, 229, 0.3);
        }
        
        .footer {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            padding: 2rem 0;
            margin-top: 3rem;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin: 1rem 0;
        }
        
        .metric-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            margin-bottom: 1rem;
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .metric-label {
            color: #6B7280;
            font-size: 0.875rem;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-heartbeat me-2"></i>HealthVerse
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/"><i class="fas fa-home me-1"></i>Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/dashboard"><i class="fas fa-chart-line me-1"></i>Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/health/log"><i class="fas fa-plus me-1"></i>Log Health</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/health/entries"><i class="fas fa-list me-1"></i>Entries</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/health/analysis"><i class="fas fa-brain me-1"></i>Analysis</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/reminders"><i class="fas fa-bell me-1"></i>Reminders</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/about"><i class="fas fa-info-circle me-1"></i>About</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <div class="main-content">
            <!-- Header -->
            <div class="row mb-4">
                <div class="col-12">
                    <h1 class="mb-3">
                        <i class="fas fa-brain me-2"></i>AI Health Analysis
                    </h1>
                    <p class="text-muted">Get personalized insights and recommendations based on your health data</p>
                </div>
            </div>
            
            <!-- Check if user has entries for real analysis -->
            <div th:if="${entries != null and #lists.size(entries) > 0}">
                <!-- Real AI Analysis Summary -->
                <div class="analysis-card">
                    <h3 class="mb-3">
                        <i class="fas fa-robot me-2"></i>AI Health Insights
                    </h3>
                    <div class="row">
                        <div class="col-md-8">
                            <div th:utext="${analysis}" style="font-size: 1.1rem; line-height: 1.6;">
                                Your personalized AI health analysis will appear here.
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="text-center">
                                <i class="fas fa-chart-line" style="font-size: 4rem; opacity: 0.8;"></i>
                                <p class="mt-2">Total Entries: <strong th:text="${#lists.size(entries)}">0</strong></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Demo Analysis for New Users -->
            <div th:if="${entries == null or #lists.size(entries) == 0}">
                <div class="alert alert-info text-center mb-4">
                    <h5><i class="fas fa-info-circle me-2"></i>Welcome to HealthVerse!</h5>
                    <p class="mb-0">Start logging your health data to get personalized AI analysis and insights!</p>
                </div>
                
                <div class="analysis-card">
                    <h3 class="mb-3">
                        <i class="fas fa-robot me-2"></i>Sample AI Health Insights
                    </h3>
                    <div class="row">
                        <div class="col-md-8">
                            <p style="font-size: 1.1rem; line-height: 1.6;">
                                This is how your personalized AI analysis will look once you start logging your health data. 
                                Our AI will analyze your mood patterns, sleep quality, dietary habits, and symptoms to provide 
                                tailored recommendations for improving your overall wellness.
                            </p>
                        </div>
                        <div class="col-md-4">
                            <div class="text-center">
                                <i class="fas fa-chart-line" style="font-size: 4rem; opacity: 0.8;"></i>
                                <p class="mt-2">Start your health journey today!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Healthcare Consultation Options -->
            <div class="row mb-4">
                <div class="col-12">
                    <h3 class="mb-3">
                        <i class="fas fa-user-md me-2"></i>Professional Healthcare Support
                    </h3>
                </div>
                
                <!-- Mental Health AI Advice -->
                <div class="col-md-6 mb-3">
                    <div class="card h-100">
                        <div class="card-body d-flex flex-column">
                            <div class="text-center mb-3">
                                <div class="consultation-icon" style="width: 80px; height: 80px; margin: 0 auto; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;">
                                    <i class="fas fa-brain"></i>
                                </div>
                            </div>
                            <h5 class="text-center mb-3">AI Mental Health Advisor</h5>
                            <p class="text-muted flex-grow-1">Get instant mental health guidance and coping strategies from our AI-powered mental wellness assistant.</p>
                            <div class="text-center">
                                <a href="/mental-health/ai-advice" class="btn btn-primary">
                                    <i class="fas fa-comments me-2"></i>Get AI Mental Health Advice
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Doctor Consultation -->
                <div class="col-md-6 mb-3">
                    <div class="card h-100">
                        <div class="card-body d-flex flex-column">
                            <div class="text-center mb-3">
                                <div class="consultation-icon" style="width: 80px; height: 80px; margin: 0 auto; background: linear-gradient(135deg, #10B981, #059669); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;">
                                    <i class="fas fa-stethoscope"></i>
                                </div>
                            </div>
                            <h5 class="text-center mb-3">Consult with Doctors</h5>
                            <p class="text-muted flex-grow-1">Connect with certified doctors and specialists for professional medical consultation and treatment.</p>
                            <div class="text-center">
                                <a href="/consultation/doctors" class="btn btn-success">
                                    <i class="fas fa-user-md me-2"></i>Find Doctors
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Health Metrics -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-value">85%</div>
                        <div class="metric-label">Positive Mood</div>
                        <span class="trend-indicator trend-positive">↑ Improving</span>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-value">7.2</div>
                        <div class="metric-label">Avg Sleep Hours</div>
                        <span class="trend-indicator trend-positive">↑ Good</span>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-value">3.5</div>
                        <div class="metric-label">Meals/Day</div>
                        <span class="trend-indicator trend-neutral">→ Stable</span>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-value">90%</div>
                        <div class="metric-label">Symptom-Free Days</div>
                        <span class="trend-indicator trend-positive">↑ Excellent</span>
                    </div>
                </div>
            </div>
            
            <!-- Charts -->
            <div class="row mb-4">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">
                                <i class="fas fa-chart-pie me-2"></i>Mood Distribution
                            </h5>
                            <div class="chart-container">
                                <canvas id="moodChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">
                                <i class="fas fa-chart-line me-2"></i>Sleep Trends
                            </h5>
                            <div class="chart-container">
                                <canvas id="sleepChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Detailed Insights -->
            <div class="row">
                <div class="col-md-6">
                    <div class="insight-card">
                        <h5>
                            <i class="fas fa-utensils me-2"></i>Nutrition Analysis
                        </h5>
                        <p class="text-muted">
                            Your diet shows good variety with regular inclusion of fruits, vegetables, and lean proteins. 
                            Consider adding more omega-3 rich foods like salmon or walnuts for better brain health.
                        </p>
                        <div class="mt-3">
                            <span class="trend-indicator trend-positive">Balanced Diet</span>
                            <span class="trend-indicator trend-neutral ms-2">Good Variety</span>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="insight-card">
                        <h5>
                            <i class="fas fa-bed me-2"></i>Sleep Quality
                        </h5>
                        <p class="text-muted">
                            Your sleep duration is within the recommended range. The consistency in your sleep schedule 
                            is contributing to your positive mood and overall well-being.
                        </p>
                        <div class="mt-3">
                            <span class="trend-indicator trend-positive">Good Duration</span>
                            <span class="trend-indicator trend-positive ms-2">Consistent</span>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="insight-card">
                        <h5>
                            <i class="fas fa-smile me-2"></i>Mental Wellness
                        </h5>
                        <p class="text-muted">
                            Your mood tracking shows a positive trend with 85% of entries being positive. 
                            This indicates good mental health and stress management.
                        </p>
                        <div class="mt-3">
                            <span class="trend-indicator trend-positive">Positive Trend</span>
                            <span class="trend-indicator trend-positive ms-2">Good Stress Management</span>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="insight-card">
                        <h5>
                            <i class="fas fa-heartbeat me-2"></i>Physical Health
                        </h5>
                        <p class="text-muted">
                            With 90% symptom-free days, your physical health is excellent. 
                            Consider adding regular exercise to further improve your cardiovascular health.
                        </p>
                        <div class="mt-3">
                            <span class="trend-indicator trend-positive">Excellent Health</span>
                            <span class="trend-indicator trend-neutral ms-2">Consider Exercise</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Items -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">
                                <i class="fas fa-tasks me-2"></i>Recommended Actions
                            </h5>
                            <div class="row">
                                <div class="col-md-6">
                                    <ul class="list-unstyled">
                                        <li class="mb-2">
                                            <i class="fas fa-check-circle text-success me-2"></i>
                                            Continue your balanced diet routine
                                        </li>
                                        <li class="mb-2">
                                            <i class="fas fa-check-circle text-success me-2"></i>
                                            Maintain your consistent sleep schedule
                                        </li>
                                        <li class="mb-2">
                                            <i class="fas fa-plus-circle text-primary me-2"></i>
                                            Add 15 minutes of daily exercise
                                        </li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <ul class="list-unstyled">
                                        <li class="mb-2">
                                            <i class="fas fa-plus-circle text-primary me-2"></i>
                                            Increase water intake to 8 glasses daily
                                        </li>
                                        <li class="mb-2">
                                            <i class="fas fa-plus-circle text-primary me-2"></i>
                                            Consider meditation for stress relief
                                        </li>
                                        <li class="mb-2">
                                            <i class="fas fa-plus-circle text-primary me-2"></i>
                                            Schedule regular health check-ups
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="text-center mt-3">
                                <a href="/health/log" class="btn btn-primary">
                                    <i class="fas fa-plus me-2"></i>Log Today's Entry
                                </a>
                                <a href="/export/pdf" class="btn btn-outline-primary ms-2">
                                    <i class="fas fa-file-pdf me-2"></i>Export Report
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5><i class="fas fa-heartbeat me-2"></i>HealthVerse</h5>
                    <p class="text-muted">Your personal health journal with AI-powered insights.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="text-muted">&copy; 2024 HealthVerse. All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script>
        // Mood Distribution Chart
        const moodCtx = document.getElementById('moodChart').getContext('2d');
        const moodChart = new Chart(moodCtx, {
            type: 'doughnut',
            data: {
                labels: ['Happy', 'Good', 'Neutral', 'Tired', 'Stressed', 'Sad'],
                datasets: [{
                    data: [40, 30, 15, 10, 3, 2],
                    backgroundColor: [
                        '#10B981',
                        '#3B82F6',
                        '#F59E0B',
                        '#8B5CF6',
                        '#EF4444',
                        '#6B7280'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                }
            }
        });

        // Sleep Trends Chart
        const sleepCtx = document.getElementById('sleepChart').getContext('2d');
        const sleepChart = new Chart(sleepCtx, {
            type: 'line',
            data: {
                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                datasets: [{
                    label: 'Sleep Hours',
                    data: [7.5, 8, 6.5, 7, 8.5, 9, 7.5],
                    borderColor: '#4F46E5',
                    backgroundColor: 'rgba(79, 70, 229, 0.1)',
                    tension: 0.4,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 10
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });
    </script>
</body>
</html> 